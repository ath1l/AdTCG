<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ad Gallery</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    .read-more {
      color: #0d6efd;
      cursor: pointer;
      text-decoration: underline;
      font-size: 0.85rem;
    }

    .card-title-overlay {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      background: rgba(0, 0, 0, 0.6);
      color: #fff;
      padding: 8px 12px;
      font-size: 1rem;
      font-weight: 600;
      text-align: center;
      backdrop-filter: blur(2px);
    }
  </style>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Nunito:ital,wght@0,200..1000;1,200..1000&family=Tiny5&family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap" rel="stylesheet">
</head>
<body class="bg-light text-center">

  <div class="container py-4">
    <h1 class="mb-4 fw-bold">Ad TCG</h1>
    <span class="subtitle">AdTCG â€” Not just ads, they're artifacts.</span>

    <div class="container my-4">
      <div class="rarity-stats d-flex justify-content-center align-items-center gap-3 p-3 shadow-sm flex-wrap">
        <p class="mb-1">Common: <%= rarityCounts.common %></p>
        <p class="mb-1">Rare: <%= rarityCounts.rare %></p>
        <p class="mb-1">Epic: <%= rarityCounts.epic %></p>
        <p class="mb-1">Legendary: <%= rarityCounts.legendary %></p>
        <p class="mb-0">Mythic: <%= rarityCounts.mythic %></p>
      </div>
    </div>

    <div class="row g-4">
      <% ads.forEach((ad, index) => { 
           const shortDesc = ad.description.length > 60 ? ad.description.slice(0, 60) + '...' : ad.description;
      %>
        <div class="col-12 col-sm-6 col-md-4 col-lg-3">
          <div class="cardes card rarity-card <%= ad.rarity %> text-dark h-100 p-0 overflow-hidden position-relative">
            <div class="badge rounded-pill px-3 mb-2 position-absolute top-0 start-0 m-2" style="z-index: 2;">
              <%= ad.rarity %>
            </div>

            <div class="position-relative">
              <img src="/uploads/<%= ad.filename %>" 
                   class="card-img-top img-fluid ad-img" 
                   alt="<%= ad.title %>" 
                   style="height: 160px; object-fit: cover; object-position: top;">
              <div class="card-title-overlay">
                <%= ad.title %>
              </div>
            </div>

            <div class="card-body d-flex flex-column align-items-center justify-content-between p-3">
              <p class="card-text small text-wrap">
                <span id="short-desc-<%= index %>" style="color: black;"><%= shortDesc %></span>
                <span id="full-desc-<%= index %>" style="display: none;color: black;"><%= ad.description %></span>
                <% if (ad.description.length > 60) { %>
                  <span class="read-more" onclick="toggleDesc(<%= index %>)">Read more</span>
                <% } %>
              </p>
            </div>
          </div>
        </div>
      <% }) %>
    </div>
  </div>

  <script>
    function toggleDesc(index) {
      const shortEl = document.getElementById(`short-desc-${index}`);
      const fullEl = document.getElementById(`full-desc-${index}`);
      const readMoreEl = shortEl.nextElementSibling.nextElementSibling;

      shortEl.style.display = 'none';
      fullEl.style.display = 'inline';
      readMoreEl.style.display = 'none';
    }
  </script>

</body>
</html>
